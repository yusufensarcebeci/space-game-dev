{"version":3,"sources":["file:///D:/CocosProjects/bionluk/muratcanko/SpaceGame/SpaceGame3D/assets/scripts/EnemyManager.ts"],"names":["_decorator","Component","instantiate","Prefab","randomRange","Vec3","GameManager","GameState","ccclass","property","EnemyManager","Number","activeEnemies","Set","spawnDepth","enemyPool","onLoad","initializeEnemyPool","spawnAllEnemies","i","poolSize","enemy","enemyPrefab","active","node","addChild","push","console","log","currentZ","spawnPos","spawnRangeX","spawnRangeY","setPosition","add","zOffset","returnEnemyToPool","delete","update","dt","gameManager","currentState","GAME_START","forEach","position","getPosition","z","moveSpeed"],"mappings":"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","sourcesContent":["import {\r\n  _decorator,\r\n  Component,\r\n  instantiate,\r\n  Node,\r\n  Prefab,\r\n  randomRange,\r\n  Vec3,\r\n} from \"cc\";\r\nimport { GameManager, GameState } from \"./GameManager\"; // GameManager ve GameState'i içe aktarıyoruz\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"EnemyManager\")\r\nexport class EnemyManager extends Component {\r\n  @property(Prefab) enemyPrefab: Prefab = null;\r\n  @property(Number) poolSize: number = 10;\r\n  @property(Number) spawnRangeX: number = 1;\r\n  @property(Number) spawnRangeY: number = 1;\r\n  @property(Number) moveSpeed: number = 3;\r\n  @property(Number) zOffset: number = 1; // Z ekseninde her bir düşman arasındaki mesafe\r\n  @property(GameManager) gameManager: GameManager = null; // GameManager referansı\r\n\r\n  activeEnemies: Set<Node> = new Set();\r\n  spawnDepth: number = 0;\r\n\r\n  private enemyPool: Node[] = [];\r\n\r\n  protected onLoad(): void {\r\n    this.initializeEnemyPool();\r\n    this.spawnAllEnemies();\r\n  }\r\n\r\n  private initializeEnemyPool() {\r\n    for (let i = 0; i < this.poolSize; i++) {\r\n      const enemy = instantiate(this.enemyPrefab);\r\n      enemy.active = false;\r\n      this.node.addChild(enemy);\r\n      this.enemyPool.push(enemy);\r\n    }\r\n    console.log(this.enemyPool);\r\n  }\r\n\r\n  private spawnAllEnemies() {\r\n    let currentZ = this.spawnDepth;\r\n\r\n    for (const enemy of this.enemyPool) {\r\n      const spawnPos = new Vec3(\r\n        randomRange(-this.spawnRangeX, this.spawnRangeX),\r\n        randomRange(-this.spawnRangeY, this.spawnRangeY),\r\n        currentZ\r\n      );\r\n      enemy.setPosition(spawnPos);\r\n      enemy.active = true;\r\n      this.activeEnemies.add(enemy);\r\n\r\n      currentZ -= this.zOffset; // Bir sonraki düşmanın z ekseninde -1 geride olmasını sağla\r\n    }\r\n  }\r\n\r\n  returnEnemyToPool(enemy: Node) {\r\n    enemy.active = false;\r\n    this.activeEnemies.delete(enemy);\r\n    this.enemyPool.push(enemy);\r\n  }\r\n\r\n  update(dt: number) {\r\n    if (this.gameManager && this.gameManager.currentState === GameState.GAME_START) {\r\n      this.activeEnemies.forEach((enemy) => {\r\n        const position = enemy.getPosition();\r\n        position.z += this.moveSpeed * dt;\r\n        enemy.setPosition(position);\r\n\r\n        // if (position.z > someThreshold) {\r\n        //   this.returnEnemyToPool(enemy);\r\n        // }\r\n      });\r\n    }\r\n  }\r\n}\r\n"]}